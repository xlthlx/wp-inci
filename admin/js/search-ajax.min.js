(r=>{r(function(){r(".cmb2-search-ajax").each(function(){let a=r(this).attr("id");var t=r(this).attr("data-queryargs"),e=r(this).attr("data-object");r(this).devbridgeAutocomplete({serviceUrl:wi.ajaxurl,type:"POST",triggerSelectOnValidInput:!0,showNoSuggestionNotice:!0,noSuggestionNotice:wi.notice,transformResult:function(t){let s=JSON.parse(t);if(r("#"+a+"_results li").length){let e=Array(),i=0;r("#"+a+"_results input").each(function(){e.push(r(this).val())}),r(s).each(function(t,a){-1<r.inArray(a.data.toString(),e)&&(s.splice(t-i,1),i++)})}return r(s).each(function(t,a){a.value=r("<textarea />").html(a.value).text()}),{suggestions:s}},params:{action:"cmb2_search_ajax_get_results",wicheck:wi.nonce,object:e,query_args:t},onSearchStart:function(){r(this).next("img.cmb2-search-ajax-spinner").css("display","inline-block")},onSearchComplete:function(){r(this).next("img.cmb2-search-ajax-spinner").hide()},onSelect:function(t){r(this).devbridgeAutocomplete("clearCache");var a=r(this).attr("id")+"_results",e=r(this).attr("data-limit"),i=r(this).attr("data-sortable");1!==e?(i=1===i?'<span class="handle"></span>':"",r("#"+a).append("<li>"+i+'<input type="hidden" name="'+a+'[]" value="'+t.data+'"><a href="'+t.guid+'" target="_blank" class="edit-link"><div class="wi_wrapper">'+t.safety+'<div class="wi_value">'+t.value+'</div></div></a><a class="remover"><span class="dashicons dashicons-no"></span><span class="dashicons dashicons-dismiss"></span></a></li>'),r(this).val(""),e===r("#"+a+" li").length?r(this).prop("disabled","disabled"):r(this).trigger("focus")()):r("input[name="+a+"]").val(t.data)}}),"1"===r(this).attr("data-sortable")&&r("#"+a+"_results").sortable({handle:".handle",placeholder:"ui-state-highlight",forcePlaceholderSize:!0}),"1"===r(this).attr("data-limit")&&r(this).on("blur",function(){var t;""===r(this).val()&&(t=r(this).attr("id")+"_results",r("input[name="+t+"]").val(""))})}),r(".cmb2-search-ajax-results").on("click","a.remover",function(){r(this).parent("li").fadeOut(400,function(){var t=r(this).parents("ul").attr("id"),t=(r(this).remove(),"#"+t);r(t).removeProp("disabled"),r(t).devbridgeAutocomplete("clearCache")})})})})(jQuery);